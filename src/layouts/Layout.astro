---
import "../styles/global.css";
import { Github, X, Mail, Sun, Moon } from "lucide-astro";

interface Props {
    title?: string;
    description?: string;
}

const { title = "ringo.sh", description = "RingoTypowriter's Personal Site" } =
    Astro.props;
---

<!doctype html>
<html lang="en" class="">
    <head>
        <script is:inline>
            // Theme initialization - runs immediately to prevent flash
            (function() {
                const stored = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const isDark = stored === 'dark' || (!stored && prefersDark);
                document.documentElement.classList.toggle('dark', isDark);
            })();
        </script>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/png" href="/favicon.png" />
        <meta name="generator" content={Astro.generator} />
        <meta name="description" content={description} />
        <title>{title}</title>

        <!-- Google Fonts Import: Google Sans Code (Priority), Space Mono (Fallback), Noto Sans SC -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:wght@400;500;700&family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Noto+Sans+SC:wght@300;400;500;700&display=swap"
            rel="stylesheet"
        />
    </head>
    <body
        class="max-w-3xl mx-auto px-6 py-12 md:py-20 flex flex-col min-h-screen"
    >
        <header class="mb-12 flex justify-between items-center">
            <a
                href="/"
                class="flex items-center gap-2 hover:no-underline group"
            >
                <img
                    src="/avatar_me.jpg"
                    alt="Avatar"
                    class="w-10 h-10 rounded-full transition-all duration-500 border border-sand-text-light/20 dark:border-sand-text-dark/20"
                />
                <span class="text-xl font-mono font-bold hidden sm:inline">ringo.sh</span>
            </a>
            <nav
                class="flex items-center gap-4 sm:gap-6 text-sm font-mono text-sand-text-light/80 dark:text-sand-text-dark/80"
            >
                <a href="/snippets">Snippets</a>
                <a href="/projects">Projects</a>
                <button
                    id="theme-toggle"
                    class="p-1.5 rounded-md hover:bg-sand-text-light/10 dark:hover:bg-sand-text-dark/10 transition-colors"
                    aria-label="Toggle theme"
                >
                    <Sun size={16} class="hidden dark:block" />
                    <Moon size={16} class="block dark:hidden" />
                </button>
            </nav>
        </header>

        <main class="flex-grow">
            <slot />
        </main>

        <footer
            class="mt-20 pt-8 border-t border-sand-text-light/10 dark:border-sand-text-dark/10 flex justify-between items-center text-xs font-mono opacity-60"
        >
            <div>
                <span>&copy; {new Date().getFullYear()} Ringotypowriter</span>
                <span class="mx-2">::</span>
                <span>PL Protocol // Online</span>
            </div>
            <div class="flex gap-4">
                <a
                    href="https://github.com/ringotypowriter"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-100 transition-opacity"
                    aria-label="GitHub"
                >
                    <Github size={16} />
                </a>
                <a
                    href="https://x.com/ringoo95"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-100 transition-opacity"
                    aria-label="X"
                >
                    <X size={16} />
                </a>
                <a
                    href="mailto:connect@ringo.sh"
                    class="hover:opacity-100 transition-opacity"
                    aria-label="Email"
                >
                    <Mail size={16} />
                </a>
            </div>
        </footer>

        <script>
            // Theme toggle functionality
            const toggle = document.getElementById('theme-toggle');
            toggle?.addEventListener('click', () => {
                const isDark = document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                // Dispatch event for components that need to react to theme changes
                window.dispatchEvent(new CustomEvent('theme-change', { detail: { isDark } }));
            });
        </script>
    </body>
</html>
